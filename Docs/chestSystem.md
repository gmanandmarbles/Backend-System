Chest System API Documentation

Overview:
The Chest System API allows you to interact with a chest system where each chest has a unique ID and contains randomly generated items. The system supports fetching chests, generating new ones, and retrieving information about available chest IDs.

---

Endpoints:

1. GET /api/chests/:id
Fetches a chest by its unique ID. If the chest doesn't exist, a new chest with random items will be generated and returned.

Request:
GET /api/chests/:id

- :id (required): The ID of the chest you wish to retrieve.

Example Request:
GET /api/chests/1

Response:
If the chest with the specified ID exists:
HTTP/1.1 200 OK
{
  "chestId": "1",
  "items": [
    {
      "itemId": "uuid1",
      "name": "Item A",
      "rarity": "common",
      "imageUrl": "http://example.com/itemA.png"
    },
    {
      "itemId": "uuid2",
      "name": "Item B",
      "rarity": "rare",
      "imageUrl": "http://example.com/itemB.png"
    }
  ],
  "createdAt": "2024-12-18T12:00:00Z"
}

If the chest with the specified ID does not exist, a new chest is generated and returned:
HTTP/1.1 200 OK
{
  "chestId": "1",
  "items": [
    {
      "itemId": "uuid3",
      "name": "Item C",
      "rarity": "legendary",
      "imageUrl": "http://example.com/itemC.png"
    },
    {
      "itemId": "uuid4",
      "name": "Item D",
      "rarity": "uncommon",
      "imageUrl": "http://example.com/itemD.png"
    }
  ],
  "createdAt": "2024-12-18T12:05:00Z"
}

Description:
- The chest is fetched by its ID. If the chest does not exist, it is generated by selecting random items from the item system.
- The chest contains items with unique IDs, names, rarities, and image URLs.

---

2. GET /api/chestnumbers
Fetches the range of available chest IDs. This will return the minimum and maximum chest IDs along with a list of all available chest IDs.

Request:
GET /api/chestnumbers

Example Request:
GET /api/chestnumbers

Response:
HTTP/1.1 200 OK
{
  "min": 1,
  "max": 5,
  "chestIds": ["1", "2", "3", "4", "5"]
}

Description:
- This endpoint will return the minimum (min) and maximum (max) chest ID numbers.
- It also returns a list of all chest IDs available in the Firestore database.

Example Log Output:
Received request for chest ID range
Fetching all chest IDs from Firestore...
Found 5 chests in Firestore.
Returning chest ID range: {"min": 1, "max": 5, "chestIds":["1","2","3","4","5"]}

---

Functions in the Backend:

1. generateChest(chestId)
This function generates a new chest by selecting random items from the item system. It saves the new chest to Firestore and returns it.

Description:
- Selects random items from the available items in the Firestore database.
- Saves the chest to Firestore.
- Returns the generated chest object.

---

2. selectRandomItems(items, count)
This function selects a random set of items from the list of all available items.

Parameters:
- items: An array of all available items.
- count: The number of items to select randomly for the chest.

Description:
- Ensures that no duplicate items are selected.
- Returns a list of randomly selected items.

---

Example Logs:

- Log when fetching a chest:
Received request for chest ID: 1
Checking if chest with ID 1 exists in Firestore...
Chest with ID 1 found in Firestore. Returning chest...

- Log when generating a chest:
Chest with ID 1 does not exist. Generating new chest...
Generating new chest with ID 1...
Fetching all items from Firestore...
Fetched 10 items from Firestore.
Selecting 3 random items for the chest...
Random items selected: Item A, Item B, Item C
Saving new chest with ID 1 to Firestore...
New chest with ID 1 generated and saved.

- Log when fetching chest range:
Received request for chest ID range
Fetching all chest IDs from Firestore...
Found 5 chests in Firestore.
Returning chest ID range: {"min": 1, "max": 5, "chestIds":["1","2","3","4","5"]}

---

Error Handling:

- If the chest is not found and an error occurs, the response will be:
HTTP/1.1 500 Internal Server Error
{
  "error": "Failed to fetch chest"
}

- If fetching chest IDs fails, the response will be:
HTTP/1.1 500 Internal Server Error
{
  "error": "Failed to fetch chest IDs"
}

---

Notes:
- Items: The items in the chest are fetched randomly from the existing items in the item system. The number of items in a chest can be adjusted by changing the count parameter in the selectRandomItems function.
- Chest Persistence: Chests are saved to Firestore, ensuring the same set of items is returned for each chest ID.
